<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Door to the Parsklands</title>

  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Baskervville&display=swap" rel="stylesheet" />

  <style>
    * { box-sizing: border-box; }

    main{
      min-height: 100vh;
      padding: 36px 8px 64px;
      position: relative;
    }

    .top-gap{ height: 22px; }

    .title-float{
      position: sticky;
      top: 10px;
      margin: 0 auto 16px;
      max-width: min(90vw, 760px);
      background: rgba(255,255,255,0.92);
      padding: 12px 18px;
      border: 4px groove #222;
      box-shadow: 4px 4px 8px #555;
      text-align: center;
      z-index: 5;
      font-family: 'Baskervville', serif;
    }

    .title-float h1{
      margin: 0;
      font-size: clamp(18px, 2.4vw, 26px);
      line-height: 1.15;
    }

    /* CALENDAR BOX */
    .calendar-wrap{
      margin: 0;
      max-width: none;
      width: 100%;
      background: rgba(255,255,255,0.92);
      padding: 12px 18px;
      border: 4px groove #222;
      box-shadow: 4px 4px 8px #555;
      font-family: 'Baskervville', serif;
      overflow: hidden;
    }

    #calendarMount{
      width: 100%;
      max-width: 100%;
      overflow-x: auto;
      overflow-y: hidden;
      font-size: 0.95em;
    }

    /* Keep calendar inside box */
    #calendarMount table{
      width: 100% !important;
      max-width: 100% !important;
      min-width: 0 !important;
      table-layout: fixed !important;
      border-collapse: collapse;
    }
    #calendarMount th, #calendarMount td{
      min-width: 0 !important;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 6px 4px;
    }
    #calendarMount *{ max-width: 100% !important; }

    /* If calendar is div/grid based */
    #calendarMount .week, #calendarMount .weeks, #calendarMount .row{
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      width: 100% !important;
      min-width: 0 !important;
    }
    #calendarMount .day, #calendarMount .date, #calendarMount .cell{
      min-width: 0 !important;
      overflow: hidden;
    }

    /* LAYOUT: calendar left, book right */
    .home-grid{
      max-width: 1700px;
      margin: 0 auto 18px;
      display: flex;
      align-items: flex-start;
      gap: 18px;
    }

    .home-grid > *{ min-width: 0; }
    .home-grid .calendar-wrap{ flex: 0 0 clamp(420px, 38vw, 560px); }
    .home-grid .book-shell{ flex: 1 1 0; }

    /* book column */
    .book-shell{
      max-width: none;
      margin: 0;
      min-width: 520px;
      width: 100%;
    }

    /* IMPORTANT: a wrapper that crops the scaled book neatly */
    .book-scale-wrap{
      width: 100%;
      overflow: hidden; /* hides any spillover after scaling */
    }

    html, body{ max-width: 100%; overflow-x: hidden; }
    img, iframe{ max-width: 100%; height: auto; }

    .spread{
      position: relative;
      background: #fff;
      border: 4px groove #222;
      box-shadow: 4px 4px 8px #555;
      width: 100%;
      max-width: 100%;
      margin: 0;
      font-family: 'Baskervville', serif;
      overflow: hidden;

      /* scaling hooks */
      transform-origin: top left;
      will-change: transform;
    }

    .spread-inner{
      position: relative;
      z-index: 2;
      display: grid;
      grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
      /* NOTE: no min-height here. Let content determine size, then we scale down if needed. */
    }

    .spread::before,
    .spread::after{
      z-index: 1;
      pointer-events: none;
    }

    .book-page{
      padding: clamp(18px, 2.6vw, 34px);
      position: relative;
      min-width: 0;
    }
    .book-page.left{
      border-right: 1px solid rgba(0,0,0,0.18);
      box-shadow: inset -18px 0 24px rgba(0,0,0,0.08);
    }
    .book-page.right{
      box-shadow: inset 18px 0 24px rgba(0,0,0,0.08);
    }

    .left-quote{
      margin-top: 6px;
      font-size: clamp(18px, 2.2vw, 26px);
      line-height: 1.45;
      color: #000;
    }

    .left-quote .line{ margin: 0; }
    .left-quote .line.indent{ margin-left: 52px; }

    .left-quote .sig{
      margin-top: 28px;
      display: flex;
      justify-content: flex-end;
      align-items: baseline;
      gap: 18px;
      font-size: clamp(18px, 2.2vw, 26px);
    }

    .left-quote .dash{ margin-right: 10px; }

    .toc{ padding-top: clamp(22px, 2.4vw, 34px); }

    .toc .section-title{
      font-weight: 800;
      font-size: clamp(20px, 2.2vw, 28px);
      margin: 0 0 18px;
      text-decoration: underline;
      text-underline-offset: 6px;
      text-decoration-thickness: 2px;
    }

    .toc .list{
      list-style: none;
      padding: 0;
      margin: 0 0 50px;
      font-size: clamp(22px, 2.4vw, 32px);
      line-height: 1.28;
      text-align: center;
    }

    .toc .list li{ margin: 4px 0; }

    .toc a{
      color: #000;
      text-decoration: none;
      font-weight: 500;
    }

    .toc a:hover{ text-decoration: underline; }

    @media (max-width: 900px){
      .home-grid{ flex-direction: column; gap: 12px; }
      .home-grid .calendar-wrap{ flex: 1 1 auto; }
      .book-shell{ min-width: 0; }

      /* On mobile: no scaling */
      .spread{
        transform: none !important;
        width: 100% !important;
      }
    }

    @media (max-width: 800px){
      .top-gap{ height: 14px; }
      .spread-inner{
        grid-template-columns: 1fr;
      }
      .book-page.left{
        border-right: none;
        border-bottom: 1px solid rgba(0,0,0,0.18);
        box-shadow: inset 0 -18px 24px rgba(0,0,0,0.08);
      }
      .book-page.right{
        box-shadow: inset 0 18px 24px rgba(0,0,0,0.08);
      }
      .left-quote .line.indent{ margin-left: 28px; }
    }
  </style>
</head>

<body>
  <div id="header"></div>

  <main>
    <div class="top-gap"></div>

    <div class="title-float">
      <h1>UNDER CONSTRUCTION</h1>
    </div>

    <div class="home-grid">

      <div class="calendar-wrap">
        <div id="calendarMount">Loading calendarâ€¦</div>
      </div>

      <div class="book-shell">
        <div class="book-scale-wrap">
          <div class="spread" id="bookSpread">
            <div class="spread-inner">

              <section class="book-page left">
                <div class="left-quote">
                  <p class="line">The Parsklands are a home of mine. Ever blooming.</p>
                  <p class="line indent">And so, my discoveries are continuous.</p>
                  <p class="line">As time is granted, entries will be updated.</p>

                  <div class="sig">
                    <span class="dash">-</span>
                    <span>Wrensul</span>
                  </div>
                </div>
              </section>

              <section class="book-page right toc">
                <div class="section-title">Field Guides -</div>
                <ul class="list">
                  <li><a href="atlas.html">Atlas</a></li>
                  <li><a href="magic.html">Magic</a></li>
                  <li><a href="creatures.html">Creatures</a></li>
                  <li><a href="gods.html">Gods</a></li>
                  <li><a href="timeline.html">Timeline</a></li>
                  <li><a href="glossary.html">Glossary</a></li>
                </ul>

                <div class="section-title">Story Telling -</div>
                <ul class="list">
                  <li><a href="words-of-parsk.html">Words of Parsk</a></li>
                  <li><a href="fables.html">Fables</a></li>
                  <li><a href="small-memories.html">Small Memories</a></li>
                  <li><a href="old-friends.html">Old Friends</a></li>
                </ul>
              </section>

            </div>
          </div>
        </div>
      </div>

    </div> <!-- /home-grid -->
  </main>

  <div id="footer"></div>

  <script>
    // header + footer
    fetch("header.html")
      .then(r => r.text())
      .then(html => { document.getElementById("header").innerHTML = html; })
      .catch(err => console.error("Header failed to load.", err));

    fetch("footer.html")
      .then(r => r.text())
      .then(html => { document.getElementById("footer").innerHTML = html; })
      .catch(err => console.error("Footer failed to load.", err));

    function syncBookToCalendar(){
      // no scaling on mobile stack
      if (window.matchMedia("(max-width: 900px)").matches) {
        const spread = document.getElementById("bookSpread");
        if (spread){
          spread.style.transform = "none";
          spread.style.width = "100%";
        }
        return;
      }

      const cal = document.querySelector(".calendar-wrap");
      const spread = document.getElementById("bookSpread");
      if (!cal || !spread) return;

      // Reset first so we can measure real height
      spread.style.transform = "none";
      spread.style.width = "100%";

      // Measure heights
      const calH = cal.getBoundingClientRect().height;
      const bookH = spread.getBoundingClientRect().height;

      if (!calH || !bookH) return;

      // Scale down only if book is taller than calendar
      const scale = (bookH > calH) ? (calH / bookH) : 1;

      spread.style.transform = `scale(${scale})`;
      // compensate width so it still fills the column visually
      spread.style.width = `${100 / scale}%`;
    }

    // calendar (needs script re-run)
    fetch("calendar.html")
      .then(r => r.text())
      .then(html => {
        document.getElementById("calendarMount").innerHTML = html;

        // re-run scripts inside injected HTML
        const scripts = document.getElementById("calendarMount").querySelectorAll("script");
        scripts.forEach(old => {
          const s = document.createElement("script");
          [...old.attributes].forEach(a => s.setAttribute(a.name, a.value));
          s.textContent = old.textContent;
          old.replaceWith(s);
        });

        // Let layout settle, then scale
        requestAnimationFrame(() => {
          requestAnimationFrame(syncBookToCalendar);
        });
      })
      .catch(err => {
        document.getElementById("calendarMount").textContent = "Calendar failed to load.";
        console.error(err);
      });

    // Re-sync on resize (debounced)
    let _resizeTimer;
    window.addEventListener("resize", () => {
      clearTimeout(_resizeTimer);
      _resizeTimer = setTimeout(syncBookToCalendar, 120);
    });

    // Re-sync when fonts finish loading (helps measurement)
    if (document.fonts && document.fonts.ready) {
      document.fonts.ready.then(() => syncBookToCalendar());
    }
  </script>
</body>
</html>